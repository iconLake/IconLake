import{d as I,u as L,E as $,m as B,o as E,c as f,b as a,t as A,e as U,F as h,h as V,i as b,k as m,A as y,B as j,C as z,_ as D}from"./index.c3ac6b9b.js";import{h as H}from"./cache.05004cf3.js";import{p as N,a as S,d as P}from"./project.3e053923.js";import"./@iconlake/client.0b258216.js";import"./extension.dbd15d4c.js";const R={class:"list"},T=["data-i"],Y=["onUpdate:modelValue","onChange"],q=["onClick"],J=I({__name:"Group",setup(K){const{t:u}=L(),x=b(),r=$().params.id,n=B([]);let i,d=0,l=!1,v=0;async function M(){N.info(r,"groups").onUpdate(async e=>{n.value=e.groups.sort((t,o)=>o.num-t.num)})}E(()=>{M().finally(()=>{x.end()})});function C(){const e={_id:"",name:u("newGroup"),num:n.value.length,icons:[]};n.value.unshift(e),p(e)}function G(e){H(`${u("delGroupConfirm")}\uFF1A${n.value[e].name}\uFF1F`,async()=>{await P(r,n.value[e]._id),n.value.splice(e,1)})}function k(e){const t=e.target.parentNode;i=t,d=e.y,l=!0,t.style.zIndex="10",v=t.offsetHeight,t.classList.add("active")}function w(e){l&&(i.style.top=`${e.y-d}px`)}function _(e){if(l){l=!1,i.style.top="0",i.style.zIndex="0",i.classList.remove("active");const t=Math.floor((e.y-d)/v),o=+i.dataset.i,c=Math.max(0,o+t);Math.abs(t)>0&&(n.value.splice(c,0,...n.value.splice(o,1)),n.value.forEach((s,F)=>{const g=n.value.length-F-1;g!==s.num&&(s.num=g,p(s))}))}}async function p(e){const t=await S(r,e);e._id||(e._id=t._id)}return(e,t)=>(m(),f(h,null,[a("div",{class:"item flex center c-main pointer",onClick:C},[a("span",null,A(U(u)("addGroup")),1),t[0]||(t[0]=a("i",{class:"iconfont icon-plus m-left"},null,-1))]),a("div",R,[(m(!0),f(h,null,V(n.value,(o,c)=>(m(),f("div",{key:o._id,class:"item flex stretch","data-i":c},[a("div",{class:"drag iconfont icon-drag",onMousedown:y(k,["prevent"]),onMousemove:w,onMouseup:y(_,["prevent"]),onMouseleave:_},null,32),j(a("input",{"onUpdate:modelValue":s=>o.name=s,class:"grow",type:"text",onChange:s=>p(o)},null,40,Y),[[z,o.name]]),a("div",{class:"opt iconfont icon-delete c-danger",onClick:s=>G(c)},null,8,q)],8,T))),128))])],64))}});const te=D(J,[["__scopeId","data-v-65655e82"]]);export{te as default};
