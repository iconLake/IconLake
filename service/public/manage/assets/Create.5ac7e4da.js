import{d as O,u as G,B as H,E as M,r as R,c as u,a as I,w as D,b as e,s as k,t as c,e as d,F as S,g as z,f as g,D as C,o as p,p as J,j as P}from"./index.61d2ae44.js";import{i as U,t as m,w as q}from"./project.64df3c63.js";import{H as K}from"./Header.ffd885e5.js";import{U as Q}from"./User.546437c7.js";import{_ as W}from"./_plugin-vue_export-helper.cdc0426e.js";const X=v=>(J("data-v-54b63032"),v=v(),P(),v),Y={class:"name"},Z={class:"tab flex"},ee={class:"wrap"},te={key:0,class:"icons flex start"},se=["viewBox","innerHTML"],oe=["title"],ne=["title"],ae={key:1,class:"upload flex center"},ce={for:"svg"},ie={key:2,class:"upload flex center"},re={for:"javascript"},le={key:3,class:"upload flex center m-top"},de={key:4,class:"extension t-center"},fe={class:"flex center download"},ue={class:"item"},pe=["src"],_e={class:"store",href:"https://chrome.google.com/webstore/detail/iconlake/lfjdnkcfpebmhjbeihnebpdalolhcmmb",target:"_blank"},he=["href"],me={class:"item"},ge=["src"],ve={class:"store",href:"https://addons.mozilla.org/zh-CN/firefox/addon/iconlake/",target:"_blank"},be={class:"item"},xe=["src"],ye={class:"store",href:"https://microsoftedge.microsoft.com/addons/detail/iconlake/ilkiempcnikelnciijanjlgmchleamjh",target:"_blank"},we={key:5,class:"flex center"},ke=["disabled"],Ce=X(()=>e("div",{class:"footer"},null,-1)),je=O({__name:"Create",setup(v){const{t:o}=G(),F=H(),B=M(),n=R({_id:F.params.id,name:"",activeTab:"svg",icons:[]}),j={};async function E(){const a=await U(n._id,"name icons");n.name=a.name,a.icons.forEach(t=>{j[t.code]=t})}E();function x(a){return n.activeTab===a?"active":""}function y(a){n.activeTab=a,n.icons.length=0,_.clear()}let _=new Map;function w(){const a=[];_.forEach((t,s)=>{var i;if(t.prefix&&t.id&&(t.code=(i=t.id)==null?void 0:i.substring(t.prefix.length)),j[t.code])return _.delete(s),m(o("codeExistsAndIconOut",{code:t.code}));a.push(t)}),n.icons=a}function A(a){const t=a.target.files;t&&t.length>0&&Array.from(t).forEach(s=>{if(s.type!=="image/svg+xml")return;const i=new FileReader;i.readAsText(s,"utf-8"),i.onload=()=>{try{const h=new DOMParser().parseFromString(i.result,"image/svg+xml"),f=s.name.substring(0,s.name.lastIndexOf("."));let l=h.documentElement.getAttribute("viewBox");if(!l){const b=h.documentElement.getAttribute("width"),T=h.documentElement.getAttribute("height");b&&T?l=`0 0 ${b} ${T}`:l=""}const L={code:f,name:f,svg:{viewBox:l,path:Array.from(h.documentElement.children).map(b=>b.outerHTML).join("")}};_.set(f,L),w()}catch(r){console.error(r),m.error(o("fileCouldNotBeParsed"))}},i.onerror=()=>{m.error(o("fileLoadFailed"))}})}function $(a){const t=a.target.files;if(t&&t.length>0){if(t[0].type!=="text/javascript")return m.error(o("pleaseSelectFile",{type:".js"}));const s=new FileReader;s.readAsText(t[0],"utf-8"),s.onload=()=>{const r=s.result.match(/<symbol.*?>.*?<\/symbol>/ig);r&&(r.forEach(h=>{const f=h.match(/^<symbol.*?id="(.*?)".*?viewBox="(.*?)">(.*?)<\/symbol>$/i);if(f){const l={id:f[1],code:f[1],svg:{viewBox:f[2],path:f[3]}};_.has(l.id)||_.set(l.id,{}),Object.assign(_.get(l.id),l)}}),w())},s.onerror=()=>{m.error(o("fileLoadFailed"))}}}function V(a){const t=a.target.files;if(t&&t.length>0){if(t[0].type!=="application/json")return m.error(o("pleaseSelectFile",{type:".json"}));const s=new FileReader;s.readAsText(t[0],"utf-8"),s.onload=()=>{const i=s.result;try{const r=JSON.parse(i),h=r.css_prefix_text;r.glyphs instanceof Array&&(r.glyphs.forEach(f=>{const l=`${h}${f.font_class}`;_.has(l)||_.set(l,{}),Object.assign(_.get(l),{name:f.name,prefix:h})}),w())}catch{m.error(o("fileCouldNotBeParsed"))}},s.onerror=()=>{m.error(o("fileLoadFailed"))}}}async function N(){await q(n._id,n.icons),m.success(o("saveDone")),B.replace(`/icons/${n._id}`)}return(a,t)=>(p(),u(S,null,[I(K,{back:`/icons/${n._id}`},{default:D(()=>[e("div",Y,c(n.name),1)]),_:1},8,["back"]),I(Q),e("div",Z,[e("div",{class:k(["item",x("svg")]),onClick:t[0]||(t[0]=s=>y("svg"))},c(d(o)("uploadSVG")),3),e("div",{class:k(["item",x("iconfont")]),onClick:t[1]||(t[1]=s=>y("iconfont"))},c(d(o)("importIconfont")),3),e("div",{class:k(["item",x("extension")]),onClick:t[2]||(t[2]=s=>y("extension"))},c(d(o)("collectSVG")),3)]),e("div",ee,[n.activeTab==="svg"||n.activeTab==="iconfont"?(p(),u("div",te,[(p(!0),u(S,null,z(n.icons,s=>{var i,r;return p(),u("div",{key:s.code,class:"item"},[(p(),u("svg",{viewBox:(i=s.svg)==null?void 0:i.viewBox,innerHTML:(r=s.svg)==null?void 0:r.path},null,8,se)),s.code?(p(),u("div",{key:0,class:"name",title:s.code},c(s.code),9,oe)):g("",!0),s.name&&s.code!==s.name?(p(),u("div",{key:1,class:"name",title:s.name},c(s.name),9,ne)):g("",!0)])}),128))])):g("",!0),n.activeTab==="svg"?(p(),u("div",ae,[e("label",ce,[C(c(d(o)("selectIconFile",{type:"SVG"}))+" ",1),e("input",{id:"svg",type:"file",onChange:A,accept:"image/svg+xml",multiple:""},null,32)])])):g("",!0),n.activeTab==="iconfont"?(p(),u("div",ie,[e("label",re,[C(c(d(o)("selectIconFile",{type:"iconfont.js"}))+" ",1),e("input",{id:"javascript",type:"file",onChange:$,accept:"text/javascript"},null,32)])])):g("",!0),n.activeTab==="iconfont"?(p(),u("div",le,[e("label",null,[C(c(d(o)("selectIconFile",{type:"iconfont.json"}))+" ",1),e("input",{type:"file",onChange:V,accept:"application/json"},null,32)])])):g("",!0),n.activeTab==="extension"?(p(),u("div",de,[e("h1",null,c(d(o)("iconlakeExtension")),1),e("h2",null,c(d(o)("collectAnySVG")),1),e("div",fe,[e("div",ue,[e("h3",null,[e("img",{class:"browser",src:"/imgs/chrome.svg"},null,8,pe)]),e("p",null,[e("a",_e,c(d(o)("webStore")),1)]),e("p",null,[e("a",{class:"file",href:"/exts/chrome.crx",target:"_blank"},c(d(o)("downloadFile")),9,he)])]),e("div",me,[e("h3",null,[e("img",{class:"browser",src:"/imgs/firefox.svg"},null,8,ge)]),e("p",null,[e("a",ve,c(d(o)("webStore")),1)])]),e("div",be,[e("h3",null,[e("img",{class:"browser",src:"/imgs/edge.svg"},null,8,xe)]),e("p",null,[e("a",ye,c(d(o)("webStore")),1)])])])])):g("",!0),n.activeTab==="svg"||n.activeTab==="iconfont"?(p(),u("div",we,[e("button",{class:"btn danger",disabled:n.icons.length===0,onClick:N},c(d(o)("save")),9,ke)])):g("",!0)]),Ce],64))}});const Ee=W(je,[["__scopeId","data-v-54b63032"]]);export{Ee as default};
