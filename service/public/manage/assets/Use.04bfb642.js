import{d as Y,u as q,E as z,r as G,p as v,ai as K,o as Q,c as r,a as w,w as Z,b as n,q as y,e as a,f as u,t as o,v as U,l as h,F as S,h as ee,i as te,k as c,A as se,_ as ne}from"./index.c3ac6b9b.js";import{p as ie,r as x,s as ae}from"./project.3e053923.js";import{H as oe}from"./Header.5323aa62.js";import{U as le}from"./User.3e9238d3.js";import{t as _,i as ce,n as D,T as re,o as ue}from"./cache.05004cf3.js";import"./base.1da06d96.js";import{E as de}from"./el-switch.bfa116ff.js";import{L}from"./Loading.7dd0339b.js";import{u as pe}from"./user.237cd0b6.js";import"./@iconlake/client.0b258216.js";import"./extension.dbd15d4c.js";import"./index.2e271802.js";const ve={class:"name"},fe={class:"tab flex"},me=["title"],ge=["title"],ye={key:0,class:"content use-css"},_e={class:"t-center"},be=["title"],Te=["title"],ke={class:"t-center operate"},he=["disabled"],xe={key:1,class:"content use-js"},Ce={class:"t-center"},Ee=["title"],$e=["title"],je={class:"t-center operate"},we=["disabled"],Ue={key:2,class:"content use-vue"},Se={class:"t-center"},De=["title"],Le={key:3,class:"content use-vue"},Ne={class:"t-center"},Ie=["title"],Ve={key:4,class:"content files"},Fe={class:"flex"},Ae={class:"help"},Me=["title","onClick"],Re={class:"expire"},Pe={key:1,class:"days"},N='<icon-svg name="home"></icon-svg>',Be=Y({__name:"Use",setup(Oe){const{t:i}=q(),I=te(),{userInfo:V}=pe(),F=z(),e=G({_id:F.params.id,name:"",class:"",prefix:"",iconUpdateTime:"",files:{},icons:[],activeTab:"css",src:"",generating:new Set,members:[]}),b=v(()=>e.members.length===0?!1:e.members.some(t=>t.userId===V._id)),f=t=>{if(t instanceof Array&&t.length>0)return t[0].createTime>=t[t.length-1].createTime?t[0]:t[t.length-1]},T=(t,s)=>t.url?t.url:t.hash?`${e.files.domain}/src/${e._id}/${t.hash}/iconlake.${s}`:"",k=t=>t>=D,A=t=>{const s=Math.ceil(t.expire-(Date.now()-+new Date(t.createTime))/ue);return s<0?0:s},C=v(()=>`<link rel="stylesheet" href="${e.src}">`),E=v(()=>`<i class="${e.class} ${e.prefix}home"></i>`),$=v(()=>`<script src="${e.src}"><\/script>`),M=v(()=>(e.activeTab==="css"||e.activeTab==="js")&&e.files[e.activeTab]instanceof Array&&e.files[e.activeTab].length>0),R=v(()=>{const t=f(e.files.css);return!t||+new Date(t.createTime)<+new Date(e.iconUpdateTime)}),P=v(()=>{const t=f(e.files.js);return!t||+new Date(t.createTime)<+new Date(e.iconUpdateTime)});K(()=>{const t=e.activeTab;if(t==="vue"||t==="react"){e.src=i("loading"),t==="vue"&&O(),t==="react"&&W();return}const s=f(e.files[t]);e.src=s?T(s,t):""});async function B(){ie.info(e._id,"name files iconUpdateTime class prefix icons.length").onUpdate(async t=>{t.files.css&&t.files.css.reverse(),t.files.js&&t.files.js.reverse(),Object.assign(e,t)})}Q(()=>{B().finally(()=>{I.end()})});function m(t){return e.activeTab===t?"active":""}function g(t){e.activeTab=t}async function j(){var l;const t=e.activeTab;if(t==="vue"||t==="react"||e.generating.has(t))return;e.generating.add(t);const s=await x(e._id,t).finally(()=>{e.generating.delete(t)});if(s.hash){const d=f(e.files[t]);(!d||d.hash!==s.hash)&&((l=e.files[t])==null||l.unshift(s)),_(i("generateDone"))}}async function O(){e.src=(await x(e._id,"vue")).content||""}async function W(){e.src=(await x(e._id,"react")).content||""}function p(t){ce(t),_(i("copyDone"))}function J(t){var l;return k(t.expire)?!0:e.activeTab!=="css"&&e.activeTab!=="js"?!1:(((l=e.files[e.activeTab])==null?void 0:l.reduce((d,X)=>d+(k(X.expire)?1:0),0))||0)>=e.files.permamentMaxNum?(_(i("generationNote",{n:e.files.permamentMaxNum})),!1):!0}async function H(t,s){e.activeTab!=="css"&&e.activeTab!=="js"||(await ae(e._id,t,e.activeTab,s),_(i("saveDone")))}return(t,s)=>(c(),r(S,null,[w(oe,{back:`/icons/${e._id}`},{default:Z(()=>[n("div",ve,o(e.name),1)]),_:1},8,["back"]),w(le),n("div",fe,[n("div",{class:y(["item",m("css")]),onClick:s[0]||(s[0]=l=>g("css"))},[s[10]||(s[10]=n("span",null,"CSS",-1)),R.value?(c(),r("span",{key:0,class:"alert",title:a(i)("upgradable")},null,8,me)):u("",!0)],2),n("div",{class:y(["item",m("js")]),onClick:s[1]||(s[1]=l=>g("js"))},[s[11]||(s[11]=n("span",null,"Javascript",-1)),P.value?(c(),r("span",{key:0,class:"alert",title:a(i)("upgradable")},null,8,ge)):u("",!0)],2),n("div",{class:y(["item",m("vue")]),onClick:s[2]||(s[2]=l=>g("vue"))}," Vue ",2),n("div",{class:y(["item",m("react")]),onClick:s[3]||(s[3]=l=>g("react"))}," React ",2)]),e.activeTab==="css"?(c(),r("div",ye,[n("h2",_e,o(a(i)("useWithType",{type:"CSS"})),1),n("p",null,o(a(i)("includeType",{type:"CSS"}))+o(a(i)("colon")),1),n("div",{class:"code flex",title:a(i)("copy"),onClick:s[4]||(s[4]=l=>p(C.value))},[n("span",null,o(C.value),1),s[12]||(s[12]=n("i",{class:"iconfont icon-copy"},null,-1))],8,be),n("p",null,o(a(i)("displayIcon"))+o(a(i)("colon")),1),n("div",{class:"code flex",title:a(i)("copy"),onClick:s[5]||(s[5]=l=>p(E.value))},[n("span",null,o(E.value),1),s[13]||(s[13]=n("i",{class:"iconfont icon-copy"},null,-1))],8,Te),n("div",ke,[b.value?(c(),r("button",{key:0,class:"btn",disabled:e.icons.length===0,onClick:j},[U(o(a(i)(e.generating.has("css")?"generating":"regenerate"))+" ",1),e.generating.has("css")?(c(),h(L,{key:0})):u("",!0)],8,he)):u("",!0)])])):e.activeTab==="js"?(c(),r("div",xe,[n("h2",Ce,o(a(i)("useWithType",{type:"Javascript"})),1),n("p",null,o(a(i)("includeType",{type:"Javascript"}))+o(a(i)("colon")),1),n("div",{class:"code flex",title:a(i)("copy"),onClick:s[6]||(s[6]=l=>p($.value))},[n("span",null,o($.value),1),s[14]||(s[14]=n("i",{class:"iconfont icon-copy"},null,-1))],8,Ee),n("p",null,o(a(i)("displayIcon"))+o(a(i)("colon")),1),n("div",{class:"code flex",title:a(i)("copy"),onClick:s[7]||(s[7]=l=>p(N))},[n("span",null,o(N)),s[15]||(s[15]=n("i",{class:"iconfont icon-copy"},null,-1))],8,$e),n("div",je,[b.value?(c(),r("button",{key:0,class:"btn",disabled:e.icons.length===0,onClick:j},[U(o(a(i)(e.generating.has("js")?"generating":"regenerate"))+" ",1),e.generating.has("js")?(c(),h(L,{key:0})):u("",!0)],8,we)):u("",!0)])])):e.activeTab==="vue"?(c(),r("div",Ue,[n("h2",Se,o(a(i)("useWithType",{type:a(i)("vueComponent")})),1),n("p",null,o(a(i)("componentFile"))+o(a(i)("colon")),1),n("div",{class:"code vue flex",title:a(i)("copy"),onClick:s[8]||(s[8]=l=>p(e.src))},[n("pre",null,o(e.src),1),s[16]||(s[16]=n("i",{class:"iconfont icon-copy"},null,-1))],8,De)])):e.activeTab==="react"?(c(),r("div",Le,[n("h2",Ne,o(a(i)("useWithType",{type:a(i)("reactComponent")})),1),n("p",null,o(a(i)("componentFile"))+o(a(i)("colon")),1),n("div",{class:"code vue flex",title:a(i)("copy"),onClick:s[9]||(s[9]=l=>p(e.src))},[n("pre",null,o(e.src),1),s[17]||(s[17]=n("i",{class:"iconfont icon-copy"},null,-1))],8,Ie)])):u("",!0),M.value?(c(),r("div",Ve,[n("div",Fe,[n("p",null,o(a(i)("generatedFileLinks")),1),n("div",Ae,o(a(i)("generationNote",{n:e.files.permamentMaxNum})),1)]),(c(!0),r(S,null,ee(e.files[e.activeTab],l=>(c(),r("div",{key:l._id,class:"code flex",title:a(i)("copy"),onClick:d=>p(T(l,e.activeTab))},[n("div",null,[n("span",null,o(T(l,e.activeTab)),1),s[18]||(s[18]=n("i",{class:"iconfont icon-copy"},null,-1))]),n("div",Re,[b.value?(c(),h(a(de),{key:0,modelValue:l.expire,"onUpdate:modelValue":d=>l.expire=d,title:a(i)("validity"),"active-value":a(D),"active-text":a(i)("permanent"),"inactive-value":a(re),"inactive-text":a(i)("temporary"),"inline-prompt":!0,"before-change":()=>J(l),onClick:se(()=>!1,["stop"]),onChange:d=>H(l._id,d)},null,8,["modelValue","onUpdate:modelValue","title","active-value","active-text","inactive-value","inactive-text","before-change","onChange"])):u("",!0),k(l.expire)?u("",!0):(c(),r("div",Pe,o(a(i)("nDaysExpire",{n:A(l)})),1))])],8,Me))),128))])):u("",!0)],64))}});const tt=ne(Be,[["__scopeId","data-v-0872db26"]]);export{tt as default};
