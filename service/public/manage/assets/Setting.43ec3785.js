import{d as S,u as $,m as O,n as H,e,k as f,c as C,J as D,f as I,b as t,t as d,l as R,q as E,_ as F,E as J,a as l,w as x,F as j,j as z,aj as A}from"./index.c3ac6b9b.js";import{H as q}from"./Header.5323aa62.js";import{U as M}from"./User.3e9238d3.js";import{O as G,t as y}from"./cache.05004cf3.js";import{L as K}from"./Loading.7dd0339b.js";import{a as P,l as Q,n as T}from"./blockchain.62e14144.js";import{u as W}from"./user.237cd0b6.js";import"./@iconlake/client.0b258216.js";import"./index.9c1809da.js";const X=["href"],Y={class:"name"},Z={class:"desc"},aa={key:1},ea=S({__name:"InfoCard",setup(L){const{t:i}=$(),{userInfo:a,getUserInfo:U}=W(),s=O(!1),o=O(!1);async function V(r){var _,m,p,v,h,g,b,k,w,N;r.preventDefault();const u=a.avatar;if(!u){y(i("setAvatarFirst"));return}if(o.value)return;o.value=!0;const c=await P(u);if(!c){y.error(i("fail")),o.value=!1;return}if(!((_=a.blockchain)!=null&&_.id)){y.error(i("bindBlockchainFirst")),o.value=!1;return}const n=await Q({address:(m=a.blockchain)==null?void 0:m.id,name:(p=a.name)!=null?p:"",description:(v=a.desc)!=null?v:"",avatar:u,avatarHash:(h=c.fileHash)!=null?h:"",medias:(g=a.medias)!=null?g:[],sex:(b=a.sex)!=null?b:"",birthday:(k=a.birthday)!=null?k:"",location:(w=a.location)!=null?w:""});n&&((n==null?void 0:n.code)===0?(y(i("updateCompleted")),s.value=!1):y((N=n==null?void 0:n.rawLog)!=null?N:i("updateFailed"))),o.value=!1}async function B(){var u,c,n,_,m,p,v,h,g,b;if(!((u=a.blockchain)!=null&&u.id))return;const r=await T((c=a.blockchain)==null?void 0:c.id);s.value=!r||((n=r.creator)==null?void 0:n.name)!==a.name||((_=r.creator)==null?void 0:_.description)!==a.desc||((m=r.creator)==null?void 0:m.avatar)!==a.avatar||JSON.stringify((p=r.creator)==null?void 0:p.medias)!==JSON.stringify((v=a.medias)==null?void 0:v.map(k=>({name:k.name,content:k.content})))||((h=r.creator)==null?void 0:h.sex)!==a.sex||((g=r.creator)==null?void 0:g.birthday)!==a.birthday||((b=r.creator)==null?void 0:b.location)!==a.location}return H(a,()=>{B()},{immediate:!0}),(r,u)=>{var c,n;return e(a).name||e(a).avatar?(f(),C("a",{key:0,class:E(["preview flex",{changed:s.value}]),href:(c=e(a).blockchain)!=null&&c.id?`${e(G)}/exhibition/creator/${(n=e(a).blockchain)==null?void 0:n.id}`:"",target:"_blank"},[e(a).avatar?(f(),C("div",{key:0,class:"avatar",style:D({backgroundImage:`url(${e(a).avatar})`})},null,4)):I("",!0),t("div",null,[t("div",Y,d(e(a).name),1),t("div",Z,d(e(a).desc),1)]),s.value?(f(),C("div",{key:1,class:"btn update-chain",onClick:V},[o.value?(f(),R(K,{key:0})):(f(),C("span",aa,d(e(i)("UpdateOnchainInformation")),1))])):I("",!0)],10,X)):I("",!0)}}});const ta=F(ea,[["__scopeId","data-v-c733f99c"]]),sa={class:"flex start main"},na={class:"menu"},ia={class:"view"},oa=S({__name:"Setting",setup(L){const{t:i}=$(),a=J().meta.referer||"/";return(U,s)=>{const o=z("RouterLink");return f(),C(j,null,[l(q,{back:e(a)},null,8,["back"]),l(M),t("div",sa,[t("div",na,[l(o,{class:"item","active-class":"active",to:"/user/setting/info"},{default:x(()=>[s[0]||(s[0]=t("i",{class:"iconfont icon-user"},null,-1)),t("span",null,d(e(i)("info")),1)]),_:1,__:[0]}),l(o,{class:"item","active-class":"active",to:"./theme"},{default:x(()=>[s[1]||(s[1]=t("i",{class:"iconfont icon-theme"},null,-1)),t("span",null,d(e(i)("theme")),1)]),_:1,__:[1]}),l(o,{class:"item","active-class":"active",to:"/user/setting/bind"},{default:x(()=>[s[2]||(s[2]=t("i",{class:"iconfont icon-bind"},null,-1)),t("span",null,d(e(i)("bind")),1)]),_:1,__:[2]}),l(o,{class:"item","active-class":"active",to:"/user/setting/usage"},{default:x(()=>[s[3]||(s[3]=t("i",{class:"iconfont icon-usage"},null,-1)),t("span",null,d(e(i)("usage")),1)]),_:1,__:[3]})]),t("div",ia,[l(ta),l(e(A))])])],64)}}});const va=F(oa,[["__scopeId","data-v-12f809bf"]]);export{va as default};
