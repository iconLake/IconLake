import{d as X,u as z,r as nt,m as g,p as O,n as q,k as c,c as m,b as t,t as l,e as o,F as B,h as V,l as w,a as C,f as x,_ as J,a3 as ot,o as ct,w as lt,v as F,g as dt,ah as rt,i as ut}from"./index.c3ac6b9b.js";import{b as mt,e as _t,s as gt,i as ht,f as vt,h as H,j as ft}from"./blockchain.62e14144.js";import{O as pt,M as j,t as p,s as kt,u as G,i as bt,v as yt,w as At,x as W,y as Lt,L as wt,b as xt}from"./cache.05004cf3.js";import{U as Dt}from"./User.3e9238d3.js";import{H as Mt}from"./Header.5323aa62.js";import{L as T}from"./Loading.7dd0339b.js";import{g as Nt}from"./blockchain.f881c816.js";import{u as Q}from"./user.237cd0b6.js";import{I as $t}from"./Icon.baf4c0eb.js";import"./@iconlake/client.0b258216.js";import"./index.9c1809da.js";import"./extension.dbd15d4c.js";const Ot={class:"timeline-container"},Tt={class:"timeline-title"},It={class:"timeline"},Bt={class:"timeline-track"},Ct={class:"timeline-date"},Et={class:"timeline-date-text"},Rt={class:"timeline-group-items"},Pt=["href"],Kt={class:"timeline-item-cover"},St={class:"timeline-item-img flex center"},Ut={key:1,class:"iconfont icon-info"},Vt={class:"timeline-item-info"},Ft={class:"timeline-item-name"},Ht={key:0,class:"timeline-empty flex center"},jt={key:1,class:"timeline-empty flex center"},Gt=X({__name:"List",setup(Y){const{t:i}=z(),{userInfo:y}=Q(),a=nt([]),h=g(!0),I=O(()=>{const u={};return[...a].sort((d,r)=>{const n=d.data.createTime?+d.data.createTime:0;return(r.data.createTime?+r.data.createTime:0)-n}).forEach(d=>{if(d.data.createTime){const n=new Date(+d.data.createTime).toLocaleDateString();u[n]||(u[n]=[]),u[n].push(d)}else{const r="unknown";u[r]||(u[r]=[]),u[r].push(d)}}),Object.entries(u).map(([d,r])=>({date:d,items:r}))});return q(()=>{var u;return(u=y.blockchain)==null?void 0:u.id},()=>{var u,_;!((u=y.blockchain)!=null&&u.id)||mt({owner:(_=y.blockchain)==null?void 0:_.id}).then(d=>{a.splice(0,a.length,...d.nfts)}).finally(()=>{h.value=!1})},{immediate:!0}),(u,_)=>(c(),m("div",Ot,[t("h2",Tt,l(o(i)("myCreations")),1),t("div",It,[_[1]||(_[1]=t("div",{class:"timeline-line"},null,-1)),t("div",Bt,[(c(!0),m(B,null,V(I.value,(d,r)=>(c(),m("div",{key:r,class:"timeline-group"},[t("div",Ct,[_[0]||(_[0]=t("div",{class:"timeline-date-dot"},null,-1)),t("div",Et,l(d.date==="unknown"?o(i)("unknown"):d.date),1)]),t("div",Rt,[(c(!0),m(B,null,V(d.items,n=>(c(),m("a",{key:n.id,class:"timeline-item",href:`${o(pt)}/exhibition/${n.classId?encodeURIComponent(n.classId):""}/${n.id?encodeURIComponent(n.id):""}`,target:"_blank"},[t("div",Kt,[t("div",St,[n.uri?(c(),w($t,{key:0,info:{name:n.data.description,code:n.data.name,img:{url:n.uri},_id:n.id,groupId:"",tags:[],blockchain:{classId:n.classId,nftId:n.id}},compress:{maxWidth:400,maxHeight:400},lazy:""},null,8,["info"])):(c(),m("i",Ut))])]),t("div",Vt,[t("div",Ft,l(n.data.name),1)])],8,Pt))),128))])]))),128))])]),h.value?(c(),m("div",Ht,[C(T),t("span",null,l(o(i)("loading")),1)])):a.length===0?(c(),m("div",jt,[_[2]||(_[2]=t("i",{class:"iconfont icon-warn heartbeat"},null,-1)),t("span",null,l(o(i)("noNFTsFound")),1)])):x("",!0)]))}});const Wt=J(Gt,[["__scopeId","data-v-804fb93d"]]),Xt={class:"token flex center"},zt={class:"item lake"},qt={class:"logo flex center"},Jt=["src"],Qt={class:"amount"},Yt={class:"num"},Zt={class:"denom"},te={class:"item drop"},ee={class:"logo flex center"},se=["src"],ae={class:"amount"},ie={class:"num"},ne={class:"denom"},oe={class:"item droping"},ce={class:"logo flex center"},le=["src"],de={class:"amount"},re={class:"label"},ue={class:"num"},me={key:1},_e={key:0,class:"operate flex center"},ge={key:0,href:"https://www.keplr.app/download",target:"_blank"},he={type:"submit",class:"btn"},ve={key:1},fe=["disabled"],pe={key:1},ke={key:1,class:"help-init"},be={class:"contact"},ye=X({__name:"Assets",setup(Y){rt(s=>({"14e2d898":h.lake.bg,ea1e8190:h.drop.bg,"0b54156c":h.droping.bg}));const{t:i}=z(),y=ut(),{userInfo:a}=Q(),h={lake:{logo:"/imgs/lake-circle.svg",bg:"url(/imgs/token-lake-bg.png)"},drop:{logo:"/imgs/drop.svg",bg:"url(/imgs/token-drop-bg.png)"},droping:{bg:"url(/imgs/token-droping-bg.png)"}},I=!!window.keplr,u=g(0),_=g(0),d=g(!1),r=g(-1),n=g(0),k=g(!1),D=g(!1),M=g(!1),N=g(),Z=setInterval(()=>{if(r.value<=0||k.value)return;const s=Math.floor((Date.now()-r.value)/1e3);n.value=s>j?j:s},1e3),E=O(()=>{var s,e;return((e=(s=N.value)==null?void 0:s.config)==null?void 0:e.backendService.initDROP)||_.value>0}),R=O(()=>!!a._id&&!!N.value&&d.value),P=O(()=>{var s;return`${i("helpToInitMintingDROP")} ${location.origin}/manage/user/assets/drop/init?addr=${(s=a==null?void 0:a.blockchain)==null?void 0:s.id}`});async function $(){const s=a;s!=null&&s.blockchain?(H(s.blockchain.id,wt).then(e=>{e!=null&&e.amount&&(_.value=+(e==null?void 0:e.amount))}).finally(()=>{d.value=!0}),H(s.blockchain.id,xt).then(e=>{e!=null&&e.amount&&(u.value=+(e==null?void 0:e.amount))}),ft(s.blockchain.id).then(e=>{e!=null&&e.last_mint_time?r.value=+(e==null?void 0:e.last_mint_time):r.value=0}).catch(()=>{r.value=0})):d.value=!0}ot(()=>{clearInterval(Z)});async function tt(){var e;if(k.value)return;if(!(a!=null&&a.blockchain)){p(i("bindBlockchainAccount"));return}if(n.value<kt){p(i("atLeast1DROP"));return}k.value=!0;const s=await _t(a.blockchain.id,`${n.value}`);s&&(s.code===0?$():p((e=s==null?void 0:s.rawLog)!=null?e:i("fail"))),k.value=!1}async function et(){var b;M.value=!0;const s=A=>{var L;console.error(A),M.value=!1,p((L=i(A.message))!=null?L:i("fail"))},e=await Nt().catch(s);if(!e)return;const v=await gt(e).catch(s);if(!v)return;const f=await G.loginByBlockchain({msg:e,sig:v.signature,pubkey:v.pub_key}).catch(s);!f||(f.userId&&f.userId!==((b=a.blockchain)==null?void 0:b.id)?(p(i("alreadyBoundAndSwitch")),G.clearCache(),setTimeout(()=>{location.reload()},2e3)):(p(i("boundAndLoadAssets")),await $(),M.value=!1))}async function st(){var s,e,v,f;((s=a==null?void 0:a.blockchain)==null?void 0:s.id)&&!D.value&&(D.value=!0,await ht((e=a==null?void 0:a.blockchain)==null?void 0:e.id,(v=a==null?void 0:a.blockchain)==null?void 0:v.id,!!((f=N.value)!=null&&f.config.backendService.initDROP))&&(p(i("alreadyMinting")),$()),D.value=!1)}async function at(){N.value=await vt()}function it(){bt(P.value),p(i("copyDone"))}return ct(async()=>{at()}),q(()=>{var s;return(s=a.blockchain)==null?void 0:s.id},()=>{var s;(s=a.blockchain)!=null&&s.id&&$().finally(()=>{y.end()})},{immediate:!0}),(s,e)=>{var v,f,b,A,L,K;return c(),m(B,null,[C(Mt,{back:!0},{default:lt(()=>{var S,U;return[t("span",null,l(o(i)("myBlockchainAddress"))+l((U=(S=o(a))==null?void 0:S.blockchain)==null?void 0:U.id),1)]}),_:1}),C(Dt),t("div",Xt,[t("div",zt,[t("div",qt,[t("img",{src:h.lake.logo,alt:"LAKE"},null,8,Jt)]),t("div",Qt,[t("span",Yt,l(o(yt)(_.value,!1)),1),t("span",Zt,l(o(At)),1)])]),t("div",te,[t("div",ee,[t("img",{src:h.drop.logo,alt:"LAKE"},null,8,se)]),t("div",ae,[t("span",ie,l(o(W)(u.value,!1)),1),t("span",ne,l(o(Lt)),1)])]),t("div",oe,[t("div",ce,[t("img",{src:h.drop.logo,alt:"LAKE"},null,8,le)]),t("div",de,[t("div",re,l(o(i)("assetsToConfirm")),1),t("span",ue,l(o(W)(n.value,!1)),1),e[0]||(e[0]=t("span",{class:"denom"},"DROP",-1))]),t("div",{class:"token-confirm flex center",onClick:tt},[k.value?(c(),w(T,{key:0})):(c(),m("span",me,l(o(i)("confirmAssets")),1))])])]),R.value?(c(),m("div",_e,[I?(f=(v=o(a))==null?void 0:v.blockchain)!=null&&f.id?r.value?x("",!0):(c(),m("button",{key:2,type:"submit",class:"btn",disabled:!E.value,onClick:st},[D.value?(c(),w(T,{key:0})):(c(),m("span",pe,l(o(i)("mintDROP")),1))],8,fe)):(c(),m("button",{key:1,type:"submit",class:"btn",onClick:et},[M.value?(c(),w(T,{key:0})):(c(),m("span",ve,l(o(i)("bindBlckchainAccount")),1))])):(c(),m("a",ge,[t("button",he,l(o(i)("installKeplr")),1)]))])):x("",!0),R.value&&((A=(b=o(a))==null?void 0:b.blockchain)==null?void 0:A.id)&&!E.value&&r.value<=0?(c(),m("div",ke,[t("p",null,l(o(i)("notEnoughLAKEToInitMintingDROP")),1),t("div",{class:"example",onClick:it},[e[1]||(e[1]=t("div",{class:"iconfont icon-copy"},null,-1)),F(" "+l(P.value),1)]),t("p",be,[F(l(o(i)("or"))+" "+l(o(i)("contactUsFromTheseMethods"))+" ",1),e[2]||(e[2]=dt('<a target="_blank" href="https://gitee.com/iconLake/IconLake" title="Gitee" data-v-f374a129><img src="/imgs/gitee-logo.svg" alt="gitee" data-v-f374a129></a><a target="_blank" href="https://github.com/iconLake/IconLake" title="Github" data-v-f374a129><img src="/imgs/github-logo.svg" alt="github" data-v-f374a129></a><a target="_blank" href="https://x.com/iconLake" title="X" data-v-f374a129><img class="x" src="/imgs/x-logo.svg" alt="x" data-v-f374a129></a><a target="_blank" href="https://weibo.com/iconLake" title="Weibo" data-v-f374a129><img class="weibo" src="/imgs/weibo-logo.png" alt="weibo" data-v-f374a129></a>',4))])])):x("",!0),(K=(L=o(a))==null?void 0:L.blockchain)!=null&&K.id?(c(),w(Wt,{key:2})):x("",!0)],64)}}});const Ce=J(ye,[["__scopeId","data-v-f374a129"]]);export{Ce as default};
