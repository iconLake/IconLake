import{d as P,u as V,E as R,m as y,r as g,o as Y,c as I,b as t,t as r,e as l,q as T,a as L,w as U,v as H,l as _,f as v,F as q,i as J,k as p,_ as Z}from"./index.c3ac6b9b.js";import"./base.1da06d96.js";import{E as j}from"./el-progress.4a229156.js";import{t as d,j as x,U as K,f as F}from"./cache.05004cf3.js";import{p as Q,g as W,e as X,u as A}from"./project.3e053923.js";import{L as b}from"./Loading.7dd0339b.js";import{A as ee}from"./AIGenerate.46d453f8.js";import"./@iconlake/client.0b258216.js";import"./extension.dbd15d4c.js";import"./blockchain.62e14144.js";import"./index.9c1809da.js";const te={class:"theme"},se={class:"title"},ae={class:"flex start opt-style"},le={class:"theme"},ne={class:"title"},ie={class:"flex start opt-type"},oe={class:"label"},ce={key:0},ue={class:"help flex start"},re={class:"input-item"},de={class:"label"},fe=["value","placeholder"],pe={class:"input-item"},me={class:"label"},ve=["value","placeholder"],he={class:"flex center"},_e=P({__name:"Theme",setup(xe){const{t:a}=V(),$=J(),f=R().params.id,c=y(!1),u=y(""),i=g({class:!1,nft:!1}),o=g({class:"",nft:""}),h=g({list:-1}),m=y(!1);Y(()=>{S().finally(()=>{$.end()})});async function S(){Q.info(f,"theme style").onUpdate(async s=>{var e,n;Object.assign(o,s.theme),Object.assign(h,s.style),c.value=!!((e=s.theme)!=null&&e.class)||!!((n=s.theme)!=null&&n.nft)})}function G(){c.value=!c.value,c.value||(o.class="",o.nft="",E())}async function k(s,e){var D;if(!s.raw||!/^text\/javascript$/i.test((D=s.raw)==null?void 0:D.type)){d(a("pleaseSelectFile",{type:"js"}));return}if(!s.size||s.size>K){d(a("fileSizeLimitExceeded"));return}i[e]=!0;const n=await A({projectId:f,_id:s.name,data:await s.raw.arrayBuffer(),dir:F.THEME}).catch(()=>{d(a("fileUploadFailed"))});i[e]=!1,n&&(o[e]=n.url||n.key)}async function O(s,e){if(!s)return;i[e]=!0;const n=await A({projectId:f,_id:`${e}-${Date.now()}.js`,data:s,dir:F.THEME}).catch(()=>{d(a("fileUploadFailed"))});i[e]=!1,n&&(o[e]=n.key)}async function N(s){await k(s,"class")}async function B(s){await k(s,"nft")}async function E(){if(!m.value){if(i.class||i.nft){d(a("waitForUploadFinish"));return}m.value=!0;try{await W(f,{class:o.class,nft:o.nft})}catch{m.value=!1;return}d(a("saveDone")),m.value=!1}}async function w(s){h.list=s,await X(f,{"style.list":s}),d(a("saveDone"))}function C(s){u.value=s}function z(s){!u.value||(O(s,u.value),u.value="")}function M(){u.value=""}return(s,e)=>(p(),I(q,null,[t("div",te,[t("p",se,r(l(a)("iconListTheme")),1),t("div",ae,[t("div",{class:T(["opt-item style-default",{active:h.list===l(x).DEFAULT}]),onClick:e[0]||(e[0]=n=>w(l(x).DEFAULT))},null,2),t("div",{class:T(["opt-item style-tidy",{active:h.list===l(x).TIDY}]),onClick:e[1]||(e[1]=n=>w(l(x).TIDY))},null,2)])]),t("div",le,[t("p",ne,r(l(a)("exhibitionTheme")),1),t("div",ie,[t("div",{class:T(["switch",{off:!c.value}]),onClick:G},null,2),t("div",oe,r(l(a)(c.value?"useDiyTheme":"useDefaultTheme")),1)]),c.value?(p(),I("div",ce,[t("p",ue,[t("span",null,r(l(a)("basedOnOpenSourceToDiyTheme")),1),e[4]||(e[4]=t("a",{target:"_blank",href:"https://gitee.com/iconLake/Theme",title:"Gitee"},[t("img",{src:"/imgs/gitee-logo.svg",alt:"gitee"})],-1)),e[5]||(e[5]=t("a",{target:"_blank",href:"https://github.com/iconLake/Theme",title:"Github"},[t("img",{src:"/imgs/github-logo.svg",alt:"github"})],-1))]),t("div",re,[t("p",de,r(l(a)("uploadExhibitionIndexComponent")),1),L(l(j),{"show-file-list":!1,"auto-upload":!1,accept:"text/javascript",onChange:N},{default:U(()=>[t("input",{value:i.class?l(a)("uploading"):o.class,type:"text",readonly:"",placeholder:`${l(a)("selectFileAndExample")}exhibition-xxxxxxxx.js`,class:"upload-content"},null,8,fe),i.class?(p(),_(b,{key:0})):v("",!0)]),_:1}),t("div",{class:"ai flex center",onClick:e[2]||(e[2]=n=>C("class"))},e[6]||(e[6]=[t("i",{class:"iconfont icon-ai"},null,-1)]))]),t("div",pe,[t("p",me,r(l(a)("uploadExhibitionNftComponent")),1),L(l(j),{"show-file-list":!1,"auto-upload":!1,accept:"text/javascript",onChange:B},{default:U(()=>[t("input",{value:i.nft?l(a)("uploading"):o.nft,type:"text",readonly:"",placeholder:`${l(a)("selectFileAndExample")}nft-xxxxxxxx.js`,class:"upload-content"},null,8,ve),i.nft?(p(),_(b,{key:0})):v("",!0)]),_:1}),t("div",{class:"ai flex center",onClick:e[3]||(e[3]=n=>C("nft"))},e[7]||(e[7]=[t("i",{class:"iconfont icon-ai"},null,-1)]))]),t("div",he,[t("button",{type:"submit",class:"btn",onClick:E},[H(r(l(a)("save"))+" ",1),m.value?(p(),_(b,{key:0})):v("",!0)])])])):v("",!0)]),u.value?(p(),_(ee,{key:0,"on-finish":z,"on-cancel":M,type:u.value,"project-id":l(f)},null,8,["type","project-id"])):v("",!0)],64))}});const je=Z(_e,[["__scopeId","data-v-4bd0182f"]]);export{je as default};
