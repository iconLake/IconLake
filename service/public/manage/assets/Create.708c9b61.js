import{d as N,h as L,C as H,u as O,i as M,o as p,j as u,k as C,l as i,w as R,m as n,x as w,t as v,F as I,p as D,E as y,n as g,q as G,s as J}from"./vendor.75eb7f42.js";import{i as P,t as _,v as U}from"./project.972f377c.js";import{H as q}from"./Header.c4625430.js";import{U as z}from"./User.27395d33.js";import{_ as K}from"./plugin-vue_export-helper.5a098b48.js";import"./index.ffae3db0.js";const Q=h=>(G("data-v-0f3c2537"),h=h(),J(),h),W={class:"name"},X={class:"tab flex"},Y={class:"wrap"},Z={class:"icons flex start"},ee=["viewBox","innerHTML"],te=["title"],se=["title"],oe={key:0,class:"upload flex center"},ne={for:"svg"},ae={key:1,class:"upload flex center"},ce={for:"javascript"},ie={key:2,class:"upload flex center m-top"},re={class:"flex center"},le=["disabled"],de=Q(()=>n("div",{class:"footer"},null,-1)),fe=N({setup(h){const{t:a}=L(),T=H(),k=O(),s=M({_id:T.params.id,name:"",activeTab:"svg",icons:[]}),F={};async function S(){const o=await P(s._id,"name icons");s.name=o.name,o.icons.forEach(t=>{F[t.code]=t})}S();function b(o){return s.activeTab===o?"active":""}function j(o){s.activeTab=o,s.icons.length=0,f.clear()}let f=new Map;function x(){const o=[];f.forEach(t=>{var e;t.prefix&&t.id&&(t.code=(e=t.id)==null?void 0:e.substring(t.prefix.length)),o.push(t)}),s.icons=o}function B(o){const t=o.target.files;t&&t.length>0&&Array.from(t).forEach(e=>{if(e.type!=="image/svg+xml")return;const l=new FileReader;l.readAsText(e,"utf-8"),l.onload=()=>{try{const m=new DOMParser().parseFromString(l.result,"image/svg+xml"),r=e.name.substring(0,e.name.lastIndexOf(".")),d={code:r,name:r,svg:{viewBox:m.documentElement.getAttribute("viewBox")||"",path:Array.from(m.documentElement.children).map(A=>A.outerHTML).join("")}};f.set(r,d),x()}catch(c){console.error(c),_.error(a("fileCouldNotBeParsed"))}},l.onerror=()=>{_.error(a("fileLoadFailed"))}})}function E(o){const t=o.target.files;if(t&&t.length>0){if(t[0].type!=="text/javascript")return _.error(a("pleaseSelectFile",{type:".js"}));const e=new FileReader;e.readAsText(t[0],"utf-8"),e.onload=()=>{const c=e.result.match(/<symbol.*?>.*?<\/symbol>/ig);c&&(c.forEach(m=>{const r=m.match(/^<symbol.*?id="(.*?)".*?viewBox="(.*?)">(.*?)<\/symbol>$/i);if(r){const d={id:r[1],code:r[1],svg:{viewBox:r[2],path:r[3]}};f.has(d.id)||f.set(d.id,{}),Object.assign(f.get(d.id),d)}}),x())},e.onerror=()=>{_.error(a("fileLoadFailed"))}}}function V(o){const t=o.target.files;if(t&&t.length>0){if(t[0].type!=="application/json")return _.error(a("pleaseSelectFile",{type:".json"}));const e=new FileReader;e.readAsText(t[0],"utf-8"),e.onload=()=>{const l=e.result;try{const c=JSON.parse(l),m=c.css_prefix_text;c.glyphs instanceof Array&&(c.glyphs.forEach(r=>{const d=`${m}${r.font_class}`;f.has(d)||f.set(d,{}),Object.assign(f.get(d),{name:r.name,prefix:m})}),x())}catch{_.error(a("fileCouldNotBeParsed"))}},e.onerror=()=>{_.error(a("fileLoadFailed"))}}}async function $(){await U(s._id,s.icons),_.success(a("saveDone")),k.replace(`/icons/${s._id}`)}return(o,t)=>(p(),u(I,null,[C(q,{back:`/icons/${i(s)._id}`},{default:R(()=>[n("div",W,v(i(s).name),1)]),_:1},8,["back"]),C(z),n("div",X,[n("div",{class:w(["item",b("svg")]),onClick:t[0]||(t[0]=e=>j("svg"))},v(i(a)("uploadSVG")),3),n("div",{class:w(["item",b("iconfont")]),onClick:t[1]||(t[1]=e=>j("iconfont"))},v(i(a)("importIconfont")),3)]),n("div",Y,[n("div",Z,[(p(!0),u(I,null,D(i(s).icons,e=>{var l,c;return p(),u("div",{key:e.code,class:"item"},[(p(),u("svg",{viewBox:(l=e.svg)==null?void 0:l.viewBox,innerHTML:(c=e.svg)==null?void 0:c.path},null,8,ee)),e.code?(p(),u("div",{key:0,class:"name",title:e.code},v(e.code),9,te)):g("",!0),e.name&&e.code!==e.name?(p(),u("div",{key:1,class:"name",title:e.name},v(e.name),9,se)):g("",!0)])}),128))]),i(s).activeTab==="svg"?(p(),u("div",oe,[n("label",ne,[y(v(i(a)("selectIconFile",{type:"SVG"}))+" ",1),n("input",{id:"svg",type:"file",onChange:B,accept:"image/svg+xml",multiple:""},null,32)])])):g("",!0),i(s).activeTab==="iconfont"?(p(),u("div",ae,[n("label",ce,[y(v(i(a)("selectIconFile",{type:"iconfont.js"}))+" ",1),n("input",{id:"javascript",type:"file",onChange:E,accept:"text/javascript"},null,32)])])):g("",!0),i(s).activeTab==="iconfont"?(p(),u("div",ie,[n("label",null,[y(v(i(a)("selectIconFile",{type:"iconfont.json"}))+" ",1),n("input",{type:"file",onChange:V,accept:"application/json"},null,32)])])):g("",!0),n("div",re,[n("button",{class:"btn danger",disabled:i(s).icons.length===0,onClick:$},v(i(a)("save")),9,le)])]),de],64))}});var he=K(fe,[["__scopeId","data-v-0f3c2537"]]);export{he as default};
