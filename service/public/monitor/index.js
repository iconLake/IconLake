var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var n,o=1,t=arguments.length;o<t;o++)for(var c in n=arguments[o])Object.prototype.hasOwnProperty.call(n,c)&&(e[c]=n[c]);return e}).apply(this,arguments)};!function(){var e=window["{{SPIDER}}"],n=window["{{HOST}}"],o=encodeURIComponent("{{_ID}}"),c="iconlakeRecord",t="function"==typeof e?e:function(){var o=[],t="iconlake",c="icon-",r=new RegExp("".concat(c,"(\\S+)"),"i");return document.body.querySelectorAll(".".concat(t)).forEach(function(e){var n=e.className.match(r),n=n?n[1]:null;n&&o.push({elem:e,code:n,prefix:c,class:t})}),o},r=location.href,a={};function i(e){fetch("".concat(n,"/visit/record/").concat(o),{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:e})}function s(e,n){void 0===n&&(n=!1);var o=a[e],t=(a[e]={},[]);Object.keys(o).forEach(function(e){e=o[e];t.push({code:e.code,prefix:e.prefix,class:e.class,count:e.elems.size,time:e.time})}),0<t.length&&(e=JSON.stringify({records:t,url:e}),n?localStorage.setItem(c,e):i(e))}new MutationObserver(function(){var o=location.href;o in a||(a[o]={}),t().forEach(function(e){var n="".concat(e.class).concat(e.prefix).concat(e.code);n in a[o]||(a[o][n]=__assign(__assign({},e),{elems:new Set,time:0})),a[o][n].elems.add(e.elem),a[o][n].time=Date.now()})}).observe(document.body,{subtree:!0,childList:!0}),setInterval(function(){r!==location.href&&(s(r),r=location.href)},20),window.addEventListener("unload",function(){s(location.href,!0)});e=localStorage.getItem(c);if(e)try{var l=JSON.parse(e);l.records instanceof Array&&0<l.records.length&&(i(e),localStorage.removeItem(c))}catch(e){console.error(e)}}();
//# sourceMappingURL=index.js.map
